<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pumukel</title>
  <link rel="icon" href="data:image/x-icon;base64,AAABAAMAICAAAAAAIABcBQAANgAAAEBAAAAAACAA/QsAAJIFAACAgAAAAAAgAJAdAACPEQAAiVB..." type="image/x-icon">
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'none'; script-src 'self' 'unsafe-inline'; style-src 'unsafe-inline'; img-src 'self' data:; connect-src 'none'; base-uri 'none'; form-action 'none'">
  <style>
    :root { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; }
    body { margin: 0; background: #0b1220; color: #e6edf3; }
    .wrap { max-width: 900px; margin: 0 auto; padding: 24px; }
    .card { background: #0f172a; border: 1px solid #1e293b; border-radius: 16px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,.25);}    
    h1 { font-size: 1.5rem; margin: 0 0 12px; }
    p.muted { color: #94a3b8; margin-top: 4px; }
    label { display:block; font-weight:600; margin: 16px 0 8px; }
    textarea, input[type="password"], input[type="text"], input[type="number"] {
      width: 100%; background: #0b1220; color: #e6edf3; border: 1px solid #334155; border-radius: 12px; padding: 12px; box-sizing: border-box;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; 
    }
    textarea { min-height: 120px; resize: vertical; }
    .row { display:flex; gap: 12px; align-items:flex-start; flex-wrap: wrap; }
    .row > * { flex: 1 1 260px; }
    .btns { display:flex; gap: 12px; flex-wrap:wrap; margin-top: 16px; }
    button { appearance:none; cursor:pointer; border:1px solid #334155; background:#111827; color:#e6edf3; padding: 10px 14px; border-radius: 12px; font-weight:600; }
    button.primary{ background:#2563eb; border-color:#1d4ed8; }
    .small { font-size: 12px; color: #94a3b8; }
    .ok { color:#22c55e; }
    .err{ color:#f87171; }
    .hint{font-size:12px;color:#a3a3a3;margin:6px 0 0}
    .footer{margin-top:18px;font-size:12px;color:#9ca3af}
    .kbd{font-family: ui-monospace, Menlo, Consolas, monospace; background:#111827; border:1px solid #334155; padding:0 6px; border-radius:6px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Pumukel</h1>
      <p class="muted">Encrypt and decrypt short secrets locally in your browser. Nothing leaves this page.</p>

      <label for="secret">Secret (plain text)</label>
      <textarea id="secret" placeholder="Paste your password here to ENCRYPT, or leave empty when DECRYPTING."></textarea>

      <div class="row">
        <div>
          <label for="pass">Passphrase (memorizable secret)</label>
          <input id="pass" type="password" placeholder="Passphrase" autocomplete="new-password" autocapitalize="off" spellcheck="false" />
          <div class="hint">This passphrase derives the key. You must remember it to decrypt later.</div>
        </div>
        <div>
          <label for="iterations">PBKDF2 iterations</label>
          <input id="iterations" type="number" value="2023" />
          <div class="hint">Higher is slower but stronger. Keep the same value when decrypting.</div>
        </div>
      </div>

      <label for="cipher">Ciphertext (portable string)</label>
      <textarea id="cipher" placeholder="Will show v1:iterations:salt:iv:ciphertext (Base64)."></textarea>

      <div class="btns">
        <button class="primary" id="btnEnc">Encrypt →</button>
        <button id="btnDec">← Decrypt</button>
        <button id="btnGen">Generate random secret</button>
        <button id="btnCopy">Copy ciphertext</button>
        <button id="btnWipe">Wipe fields</button>
      </div>

      <div id="status" class="small"></div>
      <div class="footer">Format: <span class="kbd">v1:iterations:salt_b64:iv_b64:cipher_b64</span>. AES-GCM(256) with key from PBKDF2-HMAC-SHA-256. All local. Works offline.</div>
    </div>
  </div>

<!-- JS code remains same as updated version with versioning, CSP, modern clipboard, and no 35-character mention -->
</body>
</html>
